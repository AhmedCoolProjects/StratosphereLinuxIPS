<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Slips: slips.modules.virustotal.virustotal.Module Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Slips
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>slips</b></li><li class="navelem"><b>modules</b></li><li class="navelem"><b>virustotal</b></li><li class="navelem"><b>virustotal</b></li><li class="navelem"><a class="el" href="../../dd/d6a/classslips_1_1modules_1_1virustotal_1_1virustotal_1_1Module.html">Module</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="../../de/d01/classslips_1_1modules_1_1virustotal_1_1virustotal_1_1Module-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">slips.modules.virustotal.virustotal.Module Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aa6eebafb5088af494718a095ab6d5cd3"><td class="memItemLeft" align="right" valign="top"><a id="aa6eebafb5088af494718a095ab6d5cd3"></a>
def&#160;</td><td class="memItemRight" valign="bottom"><b>__init__</b> (self, outputqueue, config, redis_port)</td></tr>
<tr class="separator:aa6eebafb5088af494718a095ab6d5cd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a000b3476f4eec1cb2d0f7bed3f65c969"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d6a/classslips_1_1modules_1_1virustotal_1_1virustotal_1_1Module.html#a000b3476f4eec1cb2d0f7bed3f65c969">print</a> (self, text, verbose=1, debug=0)</td></tr>
<tr class="separator:a000b3476f4eec1cb2d0f7bed3f65c969"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a824ad60a9983797ceabc795313424516"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d6a/classslips_1_1modules_1_1virustotal_1_1virustotal_1_1Module.html#a824ad60a9983797ceabc795313424516">count_positives</a> (self, dict response, str response_key, positive_key, total_key)</td></tr>
<tr class="separator:a824ad60a9983797ceabc795313424516"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a586aafa9e7869252fd7abedef1c674ce"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d6a/classslips_1_1modules_1_1virustotal_1_1virustotal_1_1Module.html#a586aafa9e7869252fd7abedef1c674ce">set_vt_data_in_IPInfo</a> (self, ip, cached_data)</td></tr>
<tr class="separator:a586aafa9e7869252fd7abedef1c674ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80c8f3a7156a4adc6d14d42283cd46c4"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d6a/classslips_1_1modules_1_1virustotal_1_1virustotal_1_1Module.html#a80c8f3a7156a4adc6d14d42283cd46c4">get_url_vt_data</a> (self, url)</td></tr>
<tr class="separator:a80c8f3a7156a4adc6d14d42283cd46c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a464d18bfd867272e86f6b6c205ffb9"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d6a/classslips_1_1modules_1_1virustotal_1_1virustotal_1_1Module.html#a0a464d18bfd867272e86f6b6c205ffb9">set_url_data_in_URLInfo</a> (self, url, cached_data)</td></tr>
<tr class="separator:a0a464d18bfd867272e86f6b6c205ffb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1aeda714896bd4be3f1a66b08f7ac61c"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d6a/classslips_1_1modules_1_1virustotal_1_1virustotal_1_1Module.html#a1aeda714896bd4be3f1a66b08f7ac61c">set_domain_data_in_DomainInfo</a> (self, domain, cached_data)</td></tr>
<tr class="separator:a1aeda714896bd4be3f1a66b08f7ac61c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a737374792f9831281a780260d6dfadb7"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d6a/classslips_1_1modules_1_1virustotal_1_1virustotal_1_1Module.html#a737374792f9831281a780260d6dfadb7">scan_file</a> (self, dict file_info)</td></tr>
<tr class="separator:a737374792f9831281a780260d6dfadb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a7c78f238c255d4f6ba6d28bf81f9a4"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d6a/classslips_1_1modules_1_1virustotal_1_1virustotal_1_1Module.html#a6a7c78f238c255d4f6ba6d28bf81f9a4">API_calls_thread</a> (self)</td></tr>
<tr class="separator:a6a7c78f238c255d4f6ba6d28bf81f9a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50b380b571cd377f373c6a8365213294"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d6a/classslips_1_1modules_1_1virustotal_1_1virustotal_1_1Module.html#a50b380b571cd377f373c6a8365213294">get_file_score</a> (self, md5)</td></tr>
<tr class="separator:a50b380b571cd377f373c6a8365213294"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55dcdb239603c5a1b9e0e4fe48957b9d"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d6a/classslips_1_1modules_1_1virustotal_1_1virustotal_1_1Module.html#a55dcdb239603c5a1b9e0e4fe48957b9d">get_as_owner</a> (self, response)</td></tr>
<tr class="separator:a55dcdb239603c5a1b9e0e4fe48957b9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a584be5144f4b13cdd515517f441d25ec"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d6a/classslips_1_1modules_1_1virustotal_1_1virustotal_1_1Module.html#a584be5144f4b13cdd515517f441d25ec">get_passive_dns</a> (self, response)</td></tr>
<tr class="separator:a584be5144f4b13cdd515517f441d25ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a436f4e1459b1c98edbf655977c59219e"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d6a/classslips_1_1modules_1_1virustotal_1_1virustotal_1_1Module.html#a436f4e1459b1c98edbf655977c59219e">get_ip_vt_data</a> (self, str ip)</td></tr>
<tr class="separator:a436f4e1459b1c98edbf655977c59219e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbfea780981cbfaa6e8eba7fba84e15f"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d6a/classslips_1_1modules_1_1virustotal_1_1virustotal_1_1Module.html#abbfea780981cbfaa6e8eba7fba84e15f">get_domain_vt_data</a> (self, str domain)</td></tr>
<tr class="separator:abbfea780981cbfaa6e8eba7fba84e15f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad80253cc69d6921ab2cc3a94bfd84ce7"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d6a/classslips_1_1modules_1_1virustotal_1_1virustotal_1_1Module.html#ad80253cc69d6921ab2cc3a94bfd84ce7">get_ioc_type</a> (self, ioc)</td></tr>
<tr class="separator:ad80253cc69d6921ab2cc3a94bfd84ce7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6807a40f41225fe48a0999474a11873d"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d6a/classslips_1_1modules_1_1virustotal_1_1virustotal_1_1Module.html#a6807a40f41225fe48a0999474a11873d">api_query_</a> (self, ioc, save_data=False)</td></tr>
<tr class="separator:a6807a40f41225fe48a0999474a11873d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a710603b451477d4a1358481e2c51ac64"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d6a/classslips_1_1modules_1_1virustotal_1_1virustotal_1_1Module.html#a710603b451477d4a1358481e2c51ac64">interpret_response</a> (self, dict response)</td></tr>
<tr class="separator:a710603b451477d4a1358481e2c51ac64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec9fe88901d9993bbbb5a6b5014f2b6b"><td class="memItemLeft" align="right" valign="top"><a id="aec9fe88901d9993bbbb5a6b5014f2b6b"></a>
def&#160;</td><td class="memItemRight" valign="bottom"><b>shutdown_gracefully</b> (self)</td></tr>
<tr class="separator:aec9fe88901d9993bbbb5a6b5014f2b6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af726171dc18c0559ef6bdb917215bea3"><td class="memItemLeft" align="right" valign="top"><a id="af726171dc18c0559ef6bdb917215bea3"></a>
def&#160;</td><td class="memItemRight" valign="bottom"><b>run</b> (self)</td></tr>
<tr class="separator:af726171dc18c0559ef6bdb917215bea3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a39c22de92355b966ef09b245bf0dfb5c"><td class="memItemLeft" align="right" valign="top"><a id="a39c22de92355b966ef09b245bf0dfb5c"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>outputqueue</b></td></tr>
<tr class="separator:a39c22de92355b966ef09b245bf0dfb5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe73303a69c101d4d9799659c3ec39b5"><td class="memItemLeft" align="right" valign="top"><a id="abe73303a69c101d4d9799659c3ec39b5"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>config</b></td></tr>
<tr class="separator:abe73303a69c101d4d9799659c3ec39b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86a50f8d9ecbc4afe752dbaf9c085abc"><td class="memItemLeft" align="right" valign="top"><a id="a86a50f8d9ecbc4afe752dbaf9c085abc"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>c1</b></td></tr>
<tr class="separator:a86a50f8d9ecbc4afe752dbaf9c085abc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fa42c2e98869ea28cd3f98d33ecad76"><td class="memItemLeft" align="right" valign="top"><a id="a9fa42c2e98869ea28cd3f98d33ecad76"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>c2</b></td></tr>
<tr class="separator:a9fa42c2e98869ea28cd3f98d33ecad76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa5bc9dd5c8c79e343ea6f6666e6dcea"><td class="memItemLeft" align="right" valign="top"><a id="aaa5bc9dd5c8c79e343ea6f6666e6dcea"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>c3</b></td></tr>
<tr class="separator:aaa5bc9dd5c8c79e343ea6f6666e6dcea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d9b83f8d5c3addf830ee506906c7640"><td class="memItemLeft" align="right" valign="top"><a id="a5d9b83f8d5c3addf830ee506906c7640"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>c4</b></td></tr>
<tr class="separator:a5d9b83f8d5c3addf830ee506906c7640"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5743f946e64d2a5b6ba247af2ffa9fd"><td class="memItemLeft" align="right" valign="top"><a id="ad5743f946e64d2a5b6ba247af2ffa9fd"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>key</b></td></tr>
<tr class="separator:ad5743f946e64d2a5b6ba247af2ffa9fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada6b599310bb521a764a039deb034f28"><td class="memItemLeft" align="right" valign="top"><a id="ada6b599310bb521a764a039deb034f28"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>counter</b></td></tr>
<tr class="separator:ada6b599310bb521a764a039deb034f28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0764974568299a6a9455a8d74e28fc2d"><td class="memItemLeft" align="right" valign="top"><a id="a0764974568299a6a9455a8d74e28fc2d"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>api_call_queue</b></td></tr>
<tr class="separator:a0764974568299a6a9455a8d74e28fc2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aced416e3d5e00db7176917e1d01f00f3"><td class="memItemLeft" align="right" valign="top"><a id="aced416e3d5e00db7176917e1d01f00f3"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>http</b></td></tr>
<tr class="separator:aced416e3d5e00db7176917e1d01f00f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9815419b8db65c4daffa6af250671ca9"><td class="memItemLeft" align="right" valign="top"><a id="a9815419b8db65c4daffa6af250671ca9"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>timeout</b></td></tr>
<tr class="separator:a9815419b8db65c4daffa6af250671ca9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15d1f9cdeee28aad0389320b8756f3ef"><td class="memItemLeft" align="right" valign="top"><a id="a15d1f9cdeee28aad0389320b8756f3ef"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>api_calls_thread</b></td></tr>
<tr class="separator:a15d1f9cdeee28aad0389320b8756f3ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0bd55ff77693deb73e9cbc4700258a6"><td class="memItemLeft" align="right" valign="top"><a id="ac0bd55ff77693deb73e9cbc4700258a6"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>incorrect_API_key</b></td></tr>
<tr class="separator:ac0bd55ff77693deb73e9cbc4700258a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af01815e131f715b7cb5508d3a698393c"><td class="memItemLeft" align="right" valign="top"><a id="af01815e131f715b7cb5508d3a698393c"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>key_file</b></td></tr>
<tr class="separator:af01815e131f715b7cb5508d3a698393c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4059bbff31acead493bab7e1d406d96"><td class="memItemLeft" align="right" valign="top"><a id="ac4059bbff31acead493bab7e1d406d96"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>update_period</b></td></tr>
<tr class="separator:ac4059bbff31acead493bab7e1d406d96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fc353b9b55f48e1dbe251d942dd441d"><td class="memItemLeft" align="right" valign="top"><a id="a4fc353b9b55f48e1dbe251d942dd441d"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>url</b></td></tr>
<tr class="separator:a4fc353b9b55f48e1dbe251d942dd441d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbc2bf184d70d199ab6ce356533d3070"><td class="memItemLeft" align="right" valign="top"><a id="adbc2bf184d70d199ab6ce356533d3070"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>file_info</b></td></tr>
<tr class="separator:adbc2bf184d70d199ab6ce356533d3070"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:abe7a1c51235cec191cdd071f3ca8abaa"><td class="memItemLeft" align="right" valign="top"><a id="abe7a1c51235cec191cdd071f3ca8abaa"></a>
string&#160;</td><td class="memItemRight" valign="bottom"><b>name</b> = 'virustotal'</td></tr>
<tr class="separator:abe7a1c51235cec191cdd071f3ca8abaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97d7a05c63c3275b4ce95a3599263322"><td class="memItemLeft" align="right" valign="top"><a id="a97d7a05c63c3275b4ce95a3599263322"></a>
string&#160;</td><td class="memItemRight" valign="bottom"><b>description</b> = 'IP, domain and file hash lookup on Virustotal'</td></tr>
<tr class="separator:a97d7a05c63c3275b4ce95a3599263322"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7026237616eed2d9a7efa2b9434ab5a"><td class="memItemLeft" align="right" valign="top">list&#160;</td><td class="memItemRight" valign="bottom"><b>authors</b></td></tr>
<tr class="separator:ab7026237616eed2d9a7efa2b9434ab5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a6a7c78f238c255d4f6ba6d28bf81f9a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a7c78f238c255d4f6ba6d28bf81f9a4">&#9670;&nbsp;</a></span>API_calls_thread()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.modules.virustotal.virustotal.Module.API_calls_thread </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">This thread starts if there's an API calls queue,
it operates every minute, and executes 4 api calls
from the queue then sleeps again.
</pre> 
</div>
</div>
<a id="a6807a40f41225fe48a0999474a11873d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6807a40f41225fe48a0999474a11873d">&#9670;&nbsp;</a></span>api_query_()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.modules.virustotal.virustotal.Module.api_query_ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ioc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>save_data</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Create request and perform API call
:param ioc: IP address, domain, or URL to check
:param save_data: False by default. Set to True to save each request json in a file named ip.txt
:return: Response object
</pre> 
</div>
</div>
<a id="a824ad60a9983797ceabc795313424516"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a824ad60a9983797ceabc795313424516">&#9670;&nbsp;</a></span>count_positives()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.modules.virustotal.virustotal.Module.count_positives </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dict&#160;</td>
          <td class="paramname"><em>response</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>response_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>positive_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>total_key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Count positive checks and total checks in the response, for the given category. To compute ratio of downloaded
samples, sum results for both detected and undetected dicts: "undetected_downloaded_samples" and
"detected_downloaded_samples".
:param response: json dictionary with response data
:param response_key: category to count, eg "undetected_downloaded_samples"
:param positive_key: key to use inside of the category for successful detections (usually its "positives")
:param total_key: key to use inside of the category to sum all checks (usually its "total")
:return: number of positive tests, number of total tests run
</pre> 
</div>
</div>
<a id="a55dcdb239603c5a1b9e0e4fe48957b9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55dcdb239603c5a1b9e0e4fe48957b9d">&#9670;&nbsp;</a></span>get_as_owner()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.modules.virustotal.virustotal.Module.get_as_owner </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>response</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Get as (autonomous system) owner of the IP
:param response: json dictionary with response data
</pre> 
</div>
</div>
<a id="abbfea780981cbfaa6e8eba7fba84e15f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abbfea780981cbfaa6e8eba7fba84e15f">&#9670;&nbsp;</a></span>get_domain_vt_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.modules.virustotal.virustotal.Module.get_domain_vt_data </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>domain</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Function perform API call to VirusTotal and return scores for each of
the four processed categories. Response is cached in a dictionary.
:param domain: Domain address to check
:return: 4-tuple of floats: URL ratio, downloaded file ratio, referrer file ratio, communicating file ratio
</pre> 
</div>
</div>
<a id="a50b380b571cd377f373c6a8365213294"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50b380b571cd377f373c6a8365213294">&#9670;&nbsp;</a></span>get_file_score()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.modules.virustotal.virustotal.Module.get_file_score </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>md5</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">returns the vt scores for the specified md5</pre> 
</div>
</div>
<a id="ad80253cc69d6921ab2cc3a94bfd84ce7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad80253cc69d6921ab2cc3a94bfd84ce7">&#9670;&nbsp;</a></span>get_ioc_type()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.modules.virustotal.virustotal.Module.get_ioc_type </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ioc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Check the type of ioc, returns url, ip, domain or hash type</pre> 
</div>
</div>
<a id="a436f4e1459b1c98edbf655977c59219e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a436f4e1459b1c98edbf655977c59219e">&#9670;&nbsp;</a></span>get_ip_vt_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.modules.virustotal.virustotal.Module.get_ip_vt_data </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>ip</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Function to perform API call to VirusTotal and return scores for each of
the four processed categories. Response is cached in a dictionary. Private IPs always return (0, 0, 0, 0).
:param ip: IP address to check
:return: 4-tuple of floats: URL ratio, downloaded file ratio, referrer file ratio, communicating file ratio
</pre> 
</div>
</div>
<a id="a584be5144f4b13cdd515517f441d25ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a584be5144f4b13cdd515517f441d25ec">&#9670;&nbsp;</a></span>get_passive_dns()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.modules.virustotal.virustotal.Module.get_passive_dns </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>response</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Get passive dns from virustotal response
:param response: json dictionary with response data
</pre> 
</div>
</div>
<a id="a80c8f3a7156a4adc6d14d42283cd46c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80c8f3a7156a4adc6d14d42283cd46c4">&#9670;&nbsp;</a></span>get_url_vt_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.modules.virustotal.virustotal.Module.get_url_vt_data </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>url</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Function to perform API call to VirusTotal and return the score for the URL.
Response is cached in a dictionary.
:param url: url to check
:return: URL ratio
</pre> 
</div>
</div>
<a id="a710603b451477d4a1358481e2c51ac64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a710603b451477d4a1358481e2c51ac64">&#9670;&nbsp;</a></span>interpret_response()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.modules.virustotal.virustotal.Module.interpret_response </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dict&#160;</td>
          <td class="paramname"><em>response</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Read the dictionary and compute ratio for each category.

The ratio is computed as follows:
For each IP, VT API returns data about four categories:
URLs that resolved to the IP, samples (files) downloaded
from the IP, samples (files) that contain the given IP,
and samples (programs) that contact the IP. The structure of
the data is same for all four categories.

For each sample in a category, VT asks the antivirus
engines and counts how many of them find the sample malicious.
For example, if VT asked 27 engines and four of them
found the sample malicious, the sample would be given score
4/27, where 4 is the number of successful detections,
and 27 is the total number of engines used.

The response has two fields for each category. These are
the "detected_&lt;category&gt;" field, which contains list of
samples that were found malicious by at least one engine,
and the "undetected_&lt;category&gt;" field, which contains all
the samples that none of the engines found malicious (all
samples in undetected have score 0/x). This
 means that the
response has 8 fields with scores - two (detected and
undetected) for each of the four categories. Some fields may
be missing if data for the category is not present.

To compute the ratio for a category, scores across the
 two fields are summed together. A global number of detections
is computed (sum of all positive detections across all
 samples in the detected field) and the global number of tests
is computed (sum of all "total" values in both detected
 and undetected sample lists). Now we have detections for a
category and total for a category. The ratio for a
category is detections/total. If no tests were run (the field is
empty and total=0), this would be undefined, so
the ratio is set to 0.

Ratio is computed separately for each category.

:param response: dictionary (json data from the response)
:return: four floats: url_ratio, down_file_ratio,
 ref_file_ratio, com_file_ratio
</pre> 
</div>
</div>
<a id="a000b3476f4eec1cb2d0f7bed3f65c969"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a000b3476f4eec1cb2d0f7bed3f65c969">&#9670;&nbsp;</a></span>print()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.modules.virustotal.virustotal.Module.print </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>text</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>verbose</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>debug</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Function to use to print text using the outputqueue of slips.
Slips then decides how, when and where to print this text by taking all the processes into account
:param verbose:
    0 - don't print
    1 - basic operation/proof of work
    2 - log I/O operations and filenames
    3 - log database/profile/timewindow changes
:param debug:
    0 - don't print
    1 - print exceptions
    2 - unsupported and unhandled types (cases that may cause errors)
    3 - red warnings that needs examination - developer warnings
:param text: text to print. Can include format like 'Test {}'.format('here')
</pre> 
</div>
</div>
<a id="a737374792f9831281a780260d6dfadb7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a737374792f9831281a780260d6dfadb7">&#9670;&nbsp;</a></span>scan_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.modules.virustotal.virustotal.Module.scan_file </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dict&#160;</td>
          <td class="paramname"><em>file_info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Function to scan the md5 of the file with vt and set evidence if malicious
</pre> 
</div>
</div>
<a id="a1aeda714896bd4be3f1a66b08f7ac61c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1aeda714896bd4be3f1a66b08f7ac61c">&#9670;&nbsp;</a></span>set_domain_data_in_DomainInfo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.modules.virustotal.virustotal.Module.set_domain_data_in_DomainInfo </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>domain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cached_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Function to set VirusTotal data of the domain in the DomainInfo.
It also sets asn data if it is unknown or does not exist.
</pre> 
</div>
</div>
<a id="a0a464d18bfd867272e86f6b6c205ffb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a464d18bfd867272e86f6b6c205ffb9">&#9670;&nbsp;</a></span>set_url_data_in_URLInfo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.modules.virustotal.virustotal.Module.set_url_data_in_URLInfo </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>url</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cached_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Function to set VirusTotal data of the URL in the URLInfo.
</pre> 
</div>
</div>
<a id="a586aafa9e7869252fd7abedef1c674ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a586aafa9e7869252fd7abedef1c674ce">&#9670;&nbsp;</a></span>set_vt_data_in_IPInfo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.modules.virustotal.virustotal.Module.set_vt_data_in_IPInfo </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cached_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Function to set VirusTotal data of the IP in the IPInfo.
It also sets asn data if it is unknown or does not exist.
It also set passive dns retrieved from VirusTotal.
</pre> 
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="ab7026237616eed2d9a7efa2b9434ab5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7026237616eed2d9a7efa2b9434ab5a">&#9670;&nbsp;</a></span>authors</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">list slips.modules.virustotal.virustotal.Module.authors</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=  [</div>
<div class="line">        <span class="stringliteral">&#39;Dita Hollmannova, Kamila Babayeva&#39;</span>,</div>
<div class="line">        <span class="stringliteral">&#39;Alya Gomaa&#39;</span>,</div>
<div class="line">        <span class="stringliteral">&#39;Sebastian Garcia&#39;</span>,</div>
<div class="line">    ]</div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>virustotal.py</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
