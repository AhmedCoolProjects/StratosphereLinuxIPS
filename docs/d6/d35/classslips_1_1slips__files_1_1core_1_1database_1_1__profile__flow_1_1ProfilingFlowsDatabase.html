<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Slips: slips.slips_files.core.database._profile_flow.ProfilingFlowsDatabase Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Slips
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>slips</b></li><li class="navelem"><b>slips_files</b></li><li class="navelem"><b>core</b></li><li class="navelem"><b>database</b></li><li class="navelem"><b>_profile_flow</b></li><li class="navelem"><a class="el" href="../../d6/d35/classslips_1_1slips__files_1_1core_1_1database_1_1__profile__flow_1_1ProfilingFlowsDatabase.html">ProfilingFlowsDatabase</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="../../d9/d0d/classslips_1_1slips__files_1_1core_1_1database_1_1__profile__flow_1_1ProfilingFlowsDatabase-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">slips.slips_files.core.database._profile_flow.ProfilingFlowsDatabase Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a1c80cc98a1cad5814451a24ec3cd988a"><td class="memItemLeft" align="right" valign="top"><a id="a1c80cc98a1cad5814451a24ec3cd988a"></a>
def&#160;</td><td class="memItemRight" valign="bottom"><b>__init__</b> (self)</td></tr>
<tr class="separator:a1c80cc98a1cad5814451a24ec3cd988a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf7a25ecb1154f7faeb097ee75041948"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d35/classslips_1_1slips__files_1_1core_1_1database_1_1__profile__flow_1_1ProfilingFlowsDatabase.html#aaf7a25ecb1154f7faeb097ee75041948">publish</a> (self, channel, data)</td></tr>
<tr class="separator:aaf7a25ecb1154f7faeb097ee75041948"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace9eedbaf326061d7f9b39c7f1638d4a"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d35/classslips_1_1slips__files_1_1core_1_1database_1_1__profile__flow_1_1ProfilingFlowsDatabase.html#ace9eedbaf326061d7f9b39c7f1638d4a">getIPData</a> (self, str ip)</td></tr>
<tr class="separator:ace9eedbaf326061d7f9b39c7f1638d4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf0870b733f9694630d01ead0d4d3eae"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d35/classslips_1_1slips__files_1_1core_1_1database_1_1__profile__flow_1_1ProfilingFlowsDatabase.html#acf0870b733f9694630d01ead0d4d3eae">setNewIP</a> (self, str ip)</td></tr>
<tr class="separator:acf0870b733f9694630d01ead0d4d3eae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab8892d18dab7d8010d7e9f3074a8d97"><td class="memItemLeft" align="right" valign="top"><a id="aab8892d18dab7d8010d7e9f3074a8d97"></a>
def&#160;</td><td class="memItemRight" valign="bottom"><b>ask_for_ip_info</b> (self, ip, profileid, twid, proto, starttime, uid, ip_state)</td></tr>
<tr class="separator:aab8892d18dab7d8010d7e9f3074a8d97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a194df0d2f5caf64670aa19ce2b70aa9c"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d35/classslips_1_1slips__files_1_1core_1_1database_1_1__profile__flow_1_1ProfilingFlowsDatabase.html#a194df0d2f5caf64670aa19ce2b70aa9c">update_times_contacted</a> (self, ip, direction, profileid, twid)</td></tr>
<tr class="separator:a194df0d2f5caf64670aa19ce2b70aa9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7034eae6faee64bd7b018a109c0a2e65"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d35/classslips_1_1slips__files_1_1core_1_1database_1_1__profile__flow_1_1ProfilingFlowsDatabase.html#a7034eae6faee64bd7b018a109c0a2e65">getFinalStateFromFlags</a> (self, state, pkts)</td></tr>
<tr class="separator:a7034eae6faee64bd7b018a109c0a2e65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad850bddc7687ca2e63a683cad8931246"><td class="memItemLeft" align="right" valign="top">dict&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d35/classslips_1_1slips__files_1_1core_1_1database_1_1__profile__flow_1_1ProfilingFlowsDatabase.html#ad850bddc7687ca2e63a683cad8931246">getDataFromProfileTW</a> (self, str profileid, str twid, str direction, str state, str protocol, str role, str type_data)</td></tr>
<tr class="separator:ad850bddc7687ca2e63a683cad8931246"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2c8df7f2e0a2e50c44cae2ebda31e42"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d35/classslips_1_1slips__files_1_1core_1_1database_1_1__profile__flow_1_1ProfilingFlowsDatabase.html#aa2c8df7f2e0a2e50c44cae2ebda31e42">add_ips</a> (self, profileid, twid, ip_as_obj, columns, str role)</td></tr>
<tr class="separator:aa2c8df7f2e0a2e50c44cae2ebda31e42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbda2dd430e8057d9837c9fd8f03f6b8"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d35/classslips_1_1slips__files_1_1core_1_1database_1_1__profile__flow_1_1ProfilingFlowsDatabase.html#abbda2dd430e8057d9837c9fd8f03f6b8">update_ip_info</a> (self, old_profileid_twid_data, pkts, dport, spkts, totbytes, ip, starttime, uid)</td></tr>
<tr class="separator:abbda2dd430e8057d9837c9fd8f03f6b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a533cf10bf8f64c34bd0dece956dc2e1e"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d35/classslips_1_1slips__files_1_1core_1_1database_1_1__profile__flow_1_1ProfilingFlowsDatabase.html#a533cf10bf8f64c34bd0dece956dc2e1e">print</a> (self, text, verbose=1, debug=0)</td></tr>
<tr class="separator:a533cf10bf8f64c34bd0dece956dc2e1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5434e9f2365d1014fe3e5c5bc758668c"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d35/classslips_1_1slips__files_1_1core_1_1database_1_1__profile__flow_1_1ProfilingFlowsDatabase.html#a5434e9f2365d1014fe3e5c5bc758668c">add_tuple</a> (self, profileid, twid, tupleid, data_tuple, role, starttime, uid)</td></tr>
<tr class="separator:a5434e9f2365d1014fe3e5c5bc758668c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa39b9385ba0b8cd69f85cd84c8c7c36a"><td class="memItemLeft" align="right" valign="top"><a id="aa39b9385ba0b8cd69f85cd84c8c7c36a"></a>
def&#160;</td><td class="memItemRight" valign="bottom"><b>getSlipsInternalTime</b> (self)</td></tr>
<tr class="separator:aa39b9385ba0b8cd69f85cd84c8c7c36a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04c5b7a6b579f955670d098057b70bea"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d35/classslips_1_1slips__files_1_1core_1_1database_1_1__profile__flow_1_1ProfilingFlowsDatabase.html#a04c5b7a6b579f955670d098057b70bea">search_tws_for_flow</a> (self, profileid, twid, uid)</td></tr>
<tr class="separator:a04c5b7a6b579f955670d098057b70bea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52f5cf467be59c64fb5eebc4c8680746"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d35/classslips_1_1slips__files_1_1core_1_1database_1_1__profile__flow_1_1ProfilingFlowsDatabase.html#a52f5cf467be59c64fb5eebc4c8680746">check_TW_to_close</a> (self, close_all=False)</td></tr>
<tr class="separator:a52f5cf467be59c64fb5eebc4c8680746"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96b93f0b93bba096bea7e97805dde8cd"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d35/classslips_1_1slips__files_1_1core_1_1database_1_1__profile__flow_1_1ProfilingFlowsDatabase.html#a96b93f0b93bba096bea7e97805dde8cd">markProfileTWAsClosed</a> (self, profileid_tw)</td></tr>
<tr class="separator:a96b93f0b93bba096bea7e97805dde8cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a782914f36a01da114fde575f69f09fec"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d35/classslips_1_1slips__files_1_1core_1_1database_1_1__profile__flow_1_1ProfilingFlowsDatabase.html#a782914f36a01da114fde575f69f09fec">markProfileTWAsModified</a> (self, profileid, twid, timestamp)</td></tr>
<tr class="separator:a782914f36a01da114fde575f69f09fec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c4513fbcd0b1deaa1b63ffda95f97a7"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d35/classslips_1_1slips__files_1_1core_1_1database_1_1__profile__flow_1_1ProfilingFlowsDatabase.html#a4c4513fbcd0b1deaa1b63ffda95f97a7">add_port</a> (self, str profileid, str twid, str ip_address, dict columns, str role, str port_type)</td></tr>
<tr class="separator:a4c4513fbcd0b1deaa1b63ffda95f97a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae68ee93a925cfd79108d6102d867a531"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d35/classslips_1_1slips__files_1_1core_1_1database_1_1__profile__flow_1_1ProfilingFlowsDatabase.html#ae68ee93a925cfd79108d6102d867a531">add_flow</a> (self, profileid='', twid='', stime='', dur='', saddr='', sport='', daddr='', dport='', proto='', state='', pkts='', allbytes='', spkts='', sbytes='', appproto='', uid='', label='', flow_type='')</td></tr>
<tr class="separator:ae68ee93a925cfd79108d6102d867a531"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f8f3765b017d9494b57541d1a11de70"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d35/classslips_1_1slips__files_1_1core_1_1database_1_1__profile__flow_1_1ProfilingFlowsDatabase.html#a6f8f3765b017d9494b57541d1a11de70">set_input_metadata</a> (self, dict info)</td></tr>
<tr class="separator:a6f8f3765b017d9494b57541d1a11de70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f5640cf6c3080c423a720dd5dc22196"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d35/classslips_1_1slips__files_1_1core_1_1database_1_1__profile__flow_1_1ProfilingFlowsDatabase.html#a6f5640cf6c3080c423a720dd5dc22196">get_flow</a> (self, profileid, twid, uid)</td></tr>
<tr class="separator:a6f5640cf6c3080c423a720dd5dc22196"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae81f2abeb05f5cd88d525c6d80a053da"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d35/classslips_1_1slips__files_1_1core_1_1database_1_1__profile__flow_1_1ProfilingFlowsDatabase.html#ae81f2abeb05f5cd88d525c6d80a053da">add_out_ssl</a> (self, profileid, twid, stime, daddr_as_obj, dport, flowtype, uid, version, cipher, resumed, established, cert_chain_fuids, client_cert_chain_fuids, subject, issuer, validation_status, curve, server_name, ja3, ja3s, is_DoH)</td></tr>
<tr class="separator:ae81f2abeb05f5cd88d525c6d80a053da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab75911e310f7620615a680b5276cd393"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d35/classslips_1_1slips__files_1_1core_1_1database_1_1__profile__flow_1_1ProfilingFlowsDatabase.html#ab75911e310f7620615a680b5276cd393">setInfoForIPs</a> (self, str ip, dict ipdata)</td></tr>
<tr class="separator:ab75911e310f7620615a680b5276cd393"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9f3bccd17699070800abde8d427584d"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d35/classslips_1_1slips__files_1_1core_1_1database_1_1__profile__flow_1_1ProfilingFlowsDatabase.html#ac9f3bccd17699070800abde8d427584d">add_out_http</a> (self, daddr, profileid, twid, stime, flowtype, uid, method, host, uri, version, user_agent, request_body_len, response_body_len, status_code, status_msg, resp_mime_types, resp_fuids)</td></tr>
<tr class="separator:ac9f3bccd17699070800abde8d427584d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c5b205769d0aba3b37b465074984261"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d35/classslips_1_1slips__files_1_1core_1_1database_1_1__profile__flow_1_1ProfilingFlowsDatabase.html#a1c5b205769d0aba3b37b465074984261">add_out_ssh</a> (self, profileid, twid, stime, flowtype, uid, ssh_version, auth_attempts, auth_success, client, server, cipher_alg, mac_alg, compression_alg, kex_alg, host_key_alg, host_key, daddr)</td></tr>
<tr class="separator:a1c5b205769d0aba3b37b465074984261"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac26687ec1cd7e97f1a5bbe728d983635"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d35/classslips_1_1slips__files_1_1core_1_1database_1_1__profile__flow_1_1ProfilingFlowsDatabase.html#ac26687ec1cd7e97f1a5bbe728d983635">add_out_notice</a> (self, profileid, twid, stime, daddr, sport, dport, note, msg, scanned_port, scanning_ip, uid)</td></tr>
<tr class="separator:ac26687ec1cd7e97f1a5bbe728d983635"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3e7867d4455f77aa5f2ef29b76cf773"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d35/classslips_1_1slips__files_1_1core_1_1database_1_1__profile__flow_1_1ProfilingFlowsDatabase.html#ad3e7867d4455f77aa5f2ef29b76cf773">get_reverse_dns</a> (self, ip)</td></tr>
<tr class="separator:ad3e7867d4455f77aa5f2ef29b76cf773"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb8b48060c3cfce41397f4c76ec75fa6"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d35/classslips_1_1slips__files_1_1core_1_1database_1_1__profile__flow_1_1ProfilingFlowsDatabase.html#afb8b48060c3cfce41397f4c76ec75fa6">set_dns_resolution</a> (self, str query, list answers, float ts, str uid, str qtype_name, str srcip)</td></tr>
<tr class="separator:afb8b48060c3cfce41397f4c76ec75fa6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1177468c5b924bef6023015356b4558e"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d35/classslips_1_1slips__files_1_1core_1_1database_1_1__profile__flow_1_1ProfilingFlowsDatabase.html#a1177468c5b924bef6023015356b4558e">set_domain_resolution</a> (self, domain, ips)</td></tr>
<tr class="separator:a1177468c5b924bef6023015356b4558e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd8083abb5cd5b0b0de6b1278b1f6cf3"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d35/classslips_1_1slips__files_1_1core_1_1database_1_1__profile__flow_1_1ProfilingFlowsDatabase.html#abd8083abb5cd5b0b0de6b1278b1f6cf3">getDomainData</a> (self, domain)</td></tr>
<tr class="separator:abd8083abb5cd5b0b0de6b1278b1f6cf3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1558737d8bbd7e1b7783f8ba1eff0c56"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d35/classslips_1_1slips__files_1_1core_1_1database_1_1__profile__flow_1_1ProfilingFlowsDatabase.html#a1558737d8bbd7e1b7783f8ba1eff0c56">setNewDomain</a> (self, str domain)</td></tr>
<tr class="separator:a1558737d8bbd7e1b7783f8ba1eff0c56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31e0f6c296c8916031378dc27fc447ff"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d35/classslips_1_1slips__files_1_1core_1_1database_1_1__profile__flow_1_1ProfilingFlowsDatabase.html#a31e0f6c296c8916031378dc27fc447ff">setInfoForDomains</a> (self, str domain, dict info_to_set, mode='leave')</td></tr>
<tr class="separator:a31e0f6c296c8916031378dc27fc447ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5d8ef136a0f5d1bd7579b7f2b1bafca"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d35/classslips_1_1slips__files_1_1core_1_1database_1_1__profile__flow_1_1ProfilingFlowsDatabase.html#ab5d8ef136a0f5d1bd7579b7f2b1bafca">add_out_dns</a> (self, profileid, twid, stime, flowtype, uid, query, qclass_name, qtype_name, rcode_name, answers, ttls)</td></tr>
<tr class="separator:ab5d8ef136a0f5d1bd7579b7f2b1bafca"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a49ddd5609ba6d917d86ede8b456b6045"><td class="memItemLeft" align="right" valign="top"><a id="a49ddd5609ba6d917d86ede8b456b6045"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>name</b></td></tr>
<tr class="separator:a49ddd5609ba6d917d86ede8b456b6045"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78f040c4f1457fba31a0526b00fedef0"><td class="memItemLeft" align="right" valign="top"><a id="a78f040c4f1457fba31a0526b00fedef0"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>separator</b></td></tr>
<tr class="separator:a78f040c4f1457fba31a0526b00fedef0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a005c5a4d890678f74b3cacdcf9ef1044"><td class="memItemLeft" align="right" valign="top"><a id="a005c5a4d890678f74b3cacdcf9ef1044"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>first_flow</b></td></tr>
<tr class="separator:a005c5a4d890678f74b3cacdcf9ef1044"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa551ad9f6001b661cdd7f67b835bfa4a"><td class="memItemLeft" align="right" valign="top"><a id="aa551ad9f6001b661cdd7f67b835bfa4a"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>seen_MACs</b></td></tr>
<tr class="separator:aa551ad9f6001b661cdd7f67b835bfa4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ae68ee93a925cfd79108d6102d867a531"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae68ee93a925cfd79108d6102d867a531">&#9670;&nbsp;</a></span>add_flow()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.slips_files.core.database._profile_flow.ProfilingFlowsDatabase.add_flow </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>profileid</em> = <code>''</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>twid</em> = <code>''</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>stime</em> = <code>''</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dur</em> = <code>''</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>saddr</em> = <code>''</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sport</em> = <code>''</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>daddr</em> = <code>''</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dport</em> = <code>''</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>proto</em> = <code>''</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>state</em> = <code>''</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pkts</em> = <code>''</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>allbytes</em> = <code>''</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>spkts</em> = <code>''</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sbytes</em> = <code>''</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>appproto</em> = <code>''</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>uid</em> = <code>''</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>label</em> = <code>''</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>flow_type</em> = <code>''</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Function to add a flow by interpreting the data. The flow is added to the correct TW for this profile.
The profileid is the main profile that this flow is related too.
</pre> 
</div>
</div>
<a id="aa2c8df7f2e0a2e50c44cae2ebda31e42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2c8df7f2e0a2e50c44cae2ebda31e42">&#9670;&nbsp;</a></span>add_ips()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.slips_files.core.database._profile_flow.ProfilingFlowsDatabase.add_ips </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>profileid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>twid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ip_as_obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>columns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>role</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Function to add information about an IP address
The flow can go out of the IP (we are acting as Client) or into the IP
(we are acting as Server)
ip_as_obj: IP to add. It can be a dstIP or srcIP depending on the role
role: 'Client' or 'Server'
This function does two things:
    1- Add the ip to this tw in this profile, counting how many times
    it was contacted, and storing it in the key 'DstIPs' or 'SrcIPs'
    in the hash of the profile
    2- Use the ip as a key to count how many times that IP was
    contacted on each port. We store it like this because its the
       pefect structure to detect vertical port scans later on
    3- Check if this IP has any detection in the threat intelligence
    module. The information is added by the module directly in the DB.
</pre> 
</div>
</div>
<a id="ab5d8ef136a0f5d1bd7579b7f2b1bafca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5d8ef136a0f5d1bd7579b7f2b1bafca">&#9670;&nbsp;</a></span>add_out_dns()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.slips_files.core.database._profile_flow.ProfilingFlowsDatabase.add_out_dns </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>profileid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>twid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>stime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>flowtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>uid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>query</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>qclass_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>qtype_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rcode_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>answers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ttls</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Store in the DB a DNS request
All the type of flows that are not netflows are stored in a separate hash ordered by uid.
The idea is that from the uid of a netflow, you can access which other type of info is related to that uid
</pre> 
</div>
</div>
<a id="ac9f3bccd17699070800abde8d427584d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9f3bccd17699070800abde8d427584d">&#9670;&nbsp;</a></span>add_out_http()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.slips_files.core.database._profile_flow.ProfilingFlowsDatabase.add_out_http </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>daddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>profileid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>twid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>stime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>flowtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>uid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>host</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>uri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>version</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>user_agent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>request_body_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>response_body_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>status_code</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>status_msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>resp_mime_types</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>resp_fuids</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Store in the DB a http request
All the type of flows that are not netflows are stored in a separate hash ordered by uid.
The idea is that from the uid of a netflow, you can access which other type of info is related to that uid
</pre> 
</div>
</div>
<a id="ac26687ec1cd7e97f1a5bbe728d983635"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac26687ec1cd7e97f1a5bbe728d983635">&#9670;&nbsp;</a></span>add_out_notice()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.slips_files.core.database._profile_flow.ProfilingFlowsDatabase.add_out_notice </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>profileid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>twid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>stime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>daddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sport</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dport</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>note</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>scanned_port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>scanning_ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>uid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">" Send notice.log data to new_notice channel to look for self-signed certificates</pre> 
</div>
</div>
<a id="a1c5b205769d0aba3b37b465074984261"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c5b205769d0aba3b37b465074984261">&#9670;&nbsp;</a></span>add_out_ssh()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.slips_files.core.database._profile_flow.ProfilingFlowsDatabase.add_out_ssh </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>profileid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>twid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>stime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>flowtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>uid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ssh_version</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>auth_attempts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>auth_success</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>client</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>server</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cipher_alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>mac_alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>compression_alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>kex_alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>host_key_alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>host_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>daddr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Store in the DB a SSH request
All the type of flows that are not netflows are stored in a
separate hash ordered by uid.
The idea is that from the uid of a netflow, you can access which
other type of info is related to that uid
</pre> 
</div>
</div>
<a id="ae81f2abeb05f5cd88d525c6d80a053da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae81f2abeb05f5cd88d525c6d80a053da">&#9670;&nbsp;</a></span>add_out_ssl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.slips_files.core.database._profile_flow.ProfilingFlowsDatabase.add_out_ssl </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>profileid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>twid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>stime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>daddr_as_obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dport</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>flowtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>uid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>version</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cipher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>resumed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>established</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cert_chain_fuids</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>client_cert_chain_fuids</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>subject</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>issuer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>validation_status</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>curve</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>server_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ja3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ja3s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>is_DoH</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Store in the DB an ssl request
All the type of flows that are not netflows are stored in a separate hash ordered by uid.
The idea is that from the uid of a netflow, you can access which other type of info is related to that uid
</pre> 
</div>
</div>
<a id="a4c4513fbcd0b1deaa1b63ffda95f97a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c4513fbcd0b1deaa1b63ffda95f97a7">&#9670;&nbsp;</a></span>add_port()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.slips_files.core.database._profile_flow.ProfilingFlowsDatabase.add_port </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>profileid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>twid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>ip_address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dict&#160;</td>
          <td class="paramname"><em>columns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>role</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>port_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Store info learned from ports for this flow
The flow can go out of the IP (we are acting as Client) or into the IP (we are acting as Server)
role: 'Client' or 'Server'. Client also defines that the flow is going out, Server that is going in
port_type: 'Dst' or 'Src'. Depending if this port was a destination port or a source port
</pre> 
</div>
</div>
<a id="a5434e9f2365d1014fe3e5c5bc758668c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5434e9f2365d1014fe3e5c5bc758668c">&#9670;&nbsp;</a></span>add_tuple()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.slips_files.core.database._profile_flow.ProfilingFlowsDatabase.add_tuple </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>profileid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>twid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tupleid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>data_tuple</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>role</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>starttime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>uid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Add the tuple going in or out for this profile
:param tupleid: daddr:dport:proto
role: 'Client' or 'Server'
</pre> 
</div>
</div>
<a id="a52f5cf467be59c64fb5eebc4c8680746"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52f5cf467be59c64fb5eebc4c8680746">&#9670;&nbsp;</a></span>check_TW_to_close()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.slips_files.core.database._profile_flow.ProfilingFlowsDatabase.check_TW_to_close </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>close_all</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Check if we should close some TW
Search in the modifed tw list and compare when they
were modified with the slips internal time
</pre> 
</div>
</div>
<a id="a6f5640cf6c3080c423a720dd5dc22196"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f5640cf6c3080c423a720dd5dc22196">&#9670;&nbsp;</a></span>get_flow()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.slips_files.core.database._profile_flow.ProfilingFlowsDatabase.get_flow </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>profileid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>twid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>uid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Returns the flow in the specific time
The format is a dictionary
</pre> 
</div>
</div>
<a id="ad3e7867d4455f77aa5f2ef29b76cf773"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3e7867d4455f77aa5f2ef29b76cf773">&#9670;&nbsp;</a></span>get_reverse_dns()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.slips_files.core.database._profile_flow.ProfilingFlowsDatabase.get_reverse_dns </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ip</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Get DNS name of the IP, a list
returns a dict with {ts: .. ,
            'domains': .. ,
            'uid':...,
            'resolved-by':.. } of this IP or {}

this function is called for every IP in the timeline of kalipso
</pre> 
</div>
</div>
<a id="ad850bddc7687ca2e63a683cad8931246"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad850bddc7687ca2e63a683cad8931246">&#9670;&nbsp;</a></span>getDataFromProfileTW()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> dict slips.slips_files.core.database._profile_flow.ProfilingFlowsDatabase.getDataFromProfileTW </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>profileid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>twid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>direction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>protocol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>role</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>type_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Get the info about a certain role (Client or Server),
for a particular protocol (TCP, UDP, ICMP, etc.) for a
particular State (Established, etc.)
direction: 'Dst' or 'Src'. This is used to know if you
want the data of the src ip or ports, or the data from
the dst ips or ports
state: can be 'Established' or 'NotEstablished'
protocol: can be 'TCP', 'UDP', 'ICMP' or 'IPV6ICMP'
role: can be 'Client' or 'Server'
type_data: can be 'Ports' or 'IPs'
</pre> 
</div>
</div>
<a id="abd8083abb5cd5b0b0de6b1278b1f6cf3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd8083abb5cd5b0b0de6b1278b1f6cf3">&#9670;&nbsp;</a></span>getDomainData()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.slips_files.core.database._profile_flow.ProfilingFlowsDatabase.getDomainData </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>domain</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Return information about this domain
Returns a dictionary or False if there is no domain in the database
We need to separate these three cases:
1- Domain is in the DB without data. Return empty dict.
2- Domain is in the DB with data. Return dict.
3- Domain is not in the DB. Return False
</pre> 
</div>
</div>
<a id="a7034eae6faee64bd7b018a109c0a2e65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7034eae6faee64bd7b018a109c0a2e65">&#9670;&nbsp;</a></span>getFinalStateFromFlags()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.slips_files.core.database._profile_flow.ProfilingFlowsDatabase.getFinalStateFromFlags </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pkts</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Analyze the flags given and return a summary of the state. Should work with Argus and Bro flags
We receive the pakets to distinguish some Reset connections
</pre> 
</div>
</div>
<a id="ace9eedbaf326061d7f9b39c7f1638d4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace9eedbaf326061d7f9b39c7f1638d4a">&#9670;&nbsp;</a></span>getIPData()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.slips_files.core.database._profile_flow.ProfilingFlowsDatabase.getIPData </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>ip</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Return information about this IP from IPsInfo
Returns a dictionary or False if there is no IP in the database
We need to separate these three cases:
1- IP is in the DB without data. Return empty dict.
2- IP is in the DB with data. Return dict.
3- IP is not in the DB. Return False
</pre> 
</div>
</div>
<a id="a96b93f0b93bba096bea7e97805dde8cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96b93f0b93bba096bea7e97805dde8cd">&#9670;&nbsp;</a></span>markProfileTWAsClosed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.slips_files.core.database._profile_flow.ProfilingFlowsDatabase.markProfileTWAsClosed </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>profileid_tw</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Mark the TW as closed so tools can work on its data
</pre> 
</div>
</div>
<a id="a782914f36a01da114fde575f69f09fec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a782914f36a01da114fde575f69f09fec">&#9670;&nbsp;</a></span>markProfileTWAsModified()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.slips_files.core.database._profile_flow.ProfilingFlowsDatabase.markProfileTWAsModified </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>profileid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>twid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>timestamp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Mark a TW in a profile as modified
This means:
1- To add it to the list of ModifiedTW
2- Add the timestamp received to the time_of_last_modification
   in the TW itself
3- To update the internal time of slips
4- To check if we should 'close' some TW
</pre> 
</div>
</div>
<a id="a533cf10bf8f64c34bd0dece956dc2e1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a533cf10bf8f64c34bd0dece956dc2e1e">&#9670;&nbsp;</a></span>print()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.slips_files.core.database._profile_flow.ProfilingFlowsDatabase.print </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>text</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>verbose</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>debug</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Function to use to print text using the outputqueue of slips.
Slips then decides how, when and where to print this text by taking all the processes into account
:param verbose:
    0 - don't print
    1 - basic operation/proof of work
    2 - log I/O operations and filenames
    3 - log database/profile/timewindow changes
:param debug:
    0 - don't print
    1 - print exceptions
    2 - unsupported and unhandled types (cases that may cause errors)
    3 - red warnings that needs examination - developer warnings
:param text: text to print. Can include format like 'Test {}'.format('here')
</pre> 
</div>
</div>
<a id="aaf7a25ecb1154f7faeb097ee75041948"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf7a25ecb1154f7faeb097ee75041948">&#9670;&nbsp;</a></span>publish()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.slips_files.core.database._profile_flow.ProfilingFlowsDatabase.publish </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>channel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Publish something</pre> 
</div>
</div>
<a id="a04c5b7a6b579f955670d098057b70bea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04c5b7a6b579f955670d098057b70bea">&#9670;&nbsp;</a></span>search_tws_for_flow()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.slips_files.core.database._profile_flow.ProfilingFlowsDatabase.search_tws_for_flow </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>profileid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>twid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>uid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Search for the given uid in the given twid, or the tws before
</pre> 
</div>
</div>
<a id="afb8b48060c3cfce41397f4c76ec75fa6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb8b48060c3cfce41397f4c76ec75fa6">&#9670;&nbsp;</a></span>set_dns_resolution()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.slips_files.core.database._profile_flow.ProfilingFlowsDatabase.set_dns_resolution </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>query</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">list&#160;</td>
          <td class="paramname"><em>answers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>ts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>uid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>qtype_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>srcip</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Cache DNS answers
1- For each ip in the answer, store the domain
   in DNSresolution as {ip: {ts: .. , 'domains': .. , 'uid':... }}
2- For each CNAME, store the ip

:param srcip: ip that performed the dns query
</pre> 
</div>
</div>
<a id="a1177468c5b924bef6023015356b4558e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1177468c5b924bef6023015356b4558e">&#9670;&nbsp;</a></span>set_domain_resolution()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.slips_files.core.database._profile_flow.ProfilingFlowsDatabase.set_domain_resolution </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>domain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ips</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">stores all the resolved domains with their ips in the db
</pre> 
</div>
</div>
<a id="a6f8f3765b017d9494b57541d1a11de70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f8f3765b017d9494b57541d1a11de70">&#9670;&nbsp;</a></span>set_input_metadata()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.slips_files.core.database._profile_flow.ProfilingFlowsDatabase.set_input_metadata </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dict&#160;</td>
          <td class="paramname"><em>info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">sets name, size, analysis dates in the db
</pre> 
</div>
</div>
<a id="a31e0f6c296c8916031378dc27fc447ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31e0f6c296c8916031378dc27fc447ff">&#9670;&nbsp;</a></span>setInfoForDomains()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.slips_files.core.database._profile_flow.ProfilingFlowsDatabase.setInfoForDomains </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>domain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dict&#160;</td>
          <td class="paramname"><em>info_to_set</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>mode</em> = <code>'leave'</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Store information for this domain
:param info_to_set: a dictionary, such as {'geocountry': 'rumania'} that we are
going to store for this domain
:param mode: defines how to deal with the new data
- to 'overwrite' the data with the new data
- to 'add' the data to the new data
- to 'leave' the past data untouched
</pre> 
</div>
</div>
<a id="ab75911e310f7620615a680b5276cd393"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab75911e310f7620615a680b5276cd393">&#9670;&nbsp;</a></span>setInfoForIPs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.slips_files.core.database._profile_flow.ProfilingFlowsDatabase.setInfoForIPs </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dict&#160;</td>
          <td class="paramname"><em>ipdata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Store information for this IP
We receive a dictionary, such as {'geocountry': 'rumania'} that we are
going to store for this IP.
If it was not there before we store it. If it was there before, we
overwrite it
</pre> 
</div>
</div>
<a id="a1558737d8bbd7e1b7783f8ba1eff0c56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1558737d8bbd7e1b7783f8ba1eff0c56">&#9670;&nbsp;</a></span>setNewDomain()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.slips_files.core.database._profile_flow.ProfilingFlowsDatabase.setNewDomain </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>domain</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">1- Stores this new domain in the Domains hash
2- Publishes in the channels that there is a new domain, and that we want
    data from the Threat Intelligence modules
</pre> 
</div>
</div>
<a id="acf0870b733f9694630d01ead0d4d3eae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf0870b733f9694630d01ead0d4d3eae">&#9670;&nbsp;</a></span>setNewIP()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.slips_files.core.database._profile_flow.ProfilingFlowsDatabase.setNewIP </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>ip</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">1- Stores this new IP in the IPs hash
2- Publishes in the channels that there is a new IP, and that we want
    data from the Threat Intelligence modules
Sometimes it can happend that the ip comes as an IP object, but when
accessed as str, it is automatically
converted to str
</pre> 
</div>
</div>
<a id="abbda2dd430e8057d9837c9fd8f03f6b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abbda2dd430e8057d9837c9fd8f03f6b8">&#9670;&nbsp;</a></span>update_ip_info()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.slips_files.core.database._profile_flow.ProfilingFlowsDatabase.update_ip_info </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>old_profileid_twid_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pkts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dport</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>spkts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>totbytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>starttime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>uid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">#  Updates how many times each individual DstPort was contacted,
the total flows sent by this ip and their uids,
the total packets sent by this ip,
total bytes sent by this ip
</pre> 
</div>
</div>
<a id="a194df0d2f5caf64670aa19ce2b70aa9c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a194df0d2f5caf64670aa19ce2b70aa9c">&#9670;&nbsp;</a></span>update_times_contacted()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def slips.slips_files.core.database._profile_flow.ProfilingFlowsDatabase.update_times_contacted </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>direction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>profileid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>twid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">:param ip: the ip that we want to update the times we contacted
</pre> 
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>_profile_flow.py</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
